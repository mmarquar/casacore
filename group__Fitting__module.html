<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>casacore: Fitting_module</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">casacore
   &#160;<span id="projectnumber">$Rev$</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">Fitting_module</div>  </div>
<div class="ingroups"><a class="el" href="group__scimath.html">scimath package (libcasa_scimath)</a></div></div><!--header-->
<div class="contents">

<p>Module for various forms of mathematical fitting.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__Fitting__module__internal__classes"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Fitting__module__internal__classes.html">Fitting_module_internal_classes</a></td></tr>
<tr class="memdesc:group__Fitting__module__internal__classes"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal Fitting_module classes and functions. <br/></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1FitGaussian.html">casacore::FitGaussian&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Multidimensional fitter class for Gaussians.  <a href="classcasacore_1_1FitGaussian.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1FittingProxy.html">casacore::FittingProxy</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class gives Proxy to Fitting connection.  <a href="classcasacore_1_1FittingProxy.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1GenericL2Fit.html">casacore::GenericL2Fit&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic base class for least-squares fit.  <a href="classcasacore_1_1GenericL2Fit.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1LinearFit.html">casacore::LinearFit&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class for linear least-squares fit.  <a href="classcasacore_1_1LinearFit.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1LinearFitSVD.html">casacore::LinearFitSVD&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Linear least-squares fit using Singular Value Decomposition method.  <a href="classcasacore_1_1LinearFitSVD.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1LSQaips.html">casacore::LSQaips</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface for Casacore Vectors in least squares fitting.  <a href="classcasacore_1_1LSQaips.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1LSQFit.html">casacore::LSQFit</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Basic class for the least squares fitting.  <a href="classcasacore_1_1LSQFit.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1LSQMatrix.html">casacore::LSQMatrix</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Support class for the LSQ package.  <a href="classcasacore_1_1LSQMatrix.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1LSQReal.html">casacore::LSQReal</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Typing support classes for LSQ classes.  <a href="classcasacore_1_1LSQReal.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1LSQComplex.html">casacore::LSQComplex</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type of complex numeric class indicator.  <a href="classcasacore_1_1LSQComplex.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1LSQNull.html">casacore::LSQNull</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Non relevant class indicator.  <a href="classcasacore_1_1LSQNull.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1LSQType.html">casacore::LSQType&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if pointer type.  <a href="classcasacore_1_1LSQType.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1LSQTraits.html">casacore::LSQTraits&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Traits for numeric classes used.  <a href="classcasacore_1_1LSQTraits.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1LSQTraits__F_3_01Float_01_4.html">casacore::LSQTraits_F&lt; Float &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classcasacore_1_1LSQTraits.html" title="Traits for numeric classes used.">LSQTraits</a> specialization for Float.  <a href="classcasacore_1_1LSQTraits__F_3_01Float_01_4.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1LSQTraits__D_3_01Double_01_4.html">casacore::LSQTraits_D&lt; Double &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classcasacore_1_1LSQTraits.html" title="Traits for numeric classes used.">LSQTraits</a> specialization for Double.  <a href="classcasacore_1_1LSQTraits__D_3_01Double_01_4.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1LSQTraits__CD_3_01std_1_1complex_3_01Double_01_4_01_4.html">casacore::LSQTraits_CD&lt; std::complex&lt; Double &gt; &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classcasacore_1_1LSQTraits.html" title="Traits for numeric classes used.">LSQTraits</a> specialization for DComplex.  <a href="classcasacore_1_1LSQTraits__CD_3_01std_1_1complex_3_01Double_01_4_01_4.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1LSQTraits__CF_3_01std_1_1complex_3_01Float_01_4_01_4.html">casacore::LSQTraits_CF&lt; std::complex&lt; Float &gt; &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classcasacore_1_1LSQTraits.html" title="Traits for numeric classes used.">LSQTraits</a> specialization for Complex.  <a href="classcasacore_1_1LSQTraits__CF_3_01std_1_1complex_3_01Float_01_4_01_4.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1NonLinearFit.html">casacore::NonLinearFit&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class for non-linear least-squares fit.  <a href="classcasacore_1_1NonLinearFit.html#details">More...</a><br/></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcasacore_1_1NonLinearFitLM.html">casacore::NonLinearFitLM&lt; T &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve non-linear fit with Levenberg-Marquardt method.  <a href="classcasacore_1_1NonLinearFitLM.html#details">More...</a><br/></td></tr>
</table>
<a name="details" id="details"></a><h2>Detailed Description</h2>
<p>Module for various forms of mathematical fitting. </p>
<pre class="fragment"> @anchor Fitting_module_anchor 
</pre><p>See <a href="#Fitting_module_Class_List">below</a> for an overview of the classes in this module.</p>
<h3>Prerequisite</h3>
<ul>
<li>
Basic principles can be found in <a href="../notes/224.html">Note 224</a>. </li>
</ul>
<h3>Review Status</h3>
<dl>
<dt>Reviewed By:</dt>
<dd>Neil Killeen</dd>
<dt>Date Reviewed:</dt>
<dd>2000/06/01</dd>
<dt>Demo programs:</dt>
<dd>dLSQFit,dConstraints</dd>
</dl>
<h3>Synopsis</h3>
<p>The Fitting module holds various classes and functions related to fitting models to data. Currently only least-squares fits are handled.</p>
<h3>Least-Squares Fits</h3>
<p>We are given N data points, which we will fit to a function with M adjustable parameters. N should normally be greater than M, and at least M non-dependent relations between the parameters should be given. In cases where there are less than M independent points, Singular-Value-Deconvolution methods are available. Each condition equation can be given an (estimated) standard deviation, which is comparable to the statistical weight, which is often used in place of the standard deviation.</p>
<p>The best fit is assumed to be the one which minimises the 'chi-squared'.</p>
<p>In the (rather common) case that individual errors are not known for the individual data points, one can <em>assume</em> that the individual errors are unity, calculate the best fit function, and then <em>estimate</em> the errors (assuming they are all identical) by inverting the <em>normal equations</em>. Of course, in this case we do not have an independent estimate of chi<sup>2</sup>.</p>
<p>The methods used in the Fitting module are described in <a href="../notes/224.html">Note 224</a>. The methods (both standard and SVD) are based on a Cholesky decomposition of the normal equations.</p>
<p>General background can also be found in <em>Numerical Recipes</em> by Press <em>et al.</em>.</p>
<h3>Linear Least-Squares Fits</h3>
<p>The <em>linear least squares</em> solution assumes that the fit function is a linear combination of M linear condition equations. It is important to note that <em>linear</em> refers to the dependence on the parameters; the condition equations may be very non-linear in the dependent arguments.</p>
<p>The linear least squares problem is solved by explicitly forming and inverting the normal equations. If the normal equations are close to singular, the <em>singular value decomposition</em> (SVD) method may be used. <em>Numerical Recipes</em> suggests the SVD be always used, however this advice is not universally accepted.</p>
<h3>Linear Least-Squares Fits with Known Linear Constraints</h3>
<p>Sometimes there are not enough independent observations, <em>i.e.</em>, the number of data points <em>N</em> is less than the number of adjustable parameters <em>M</em>. In this case the least-squares problem cannot be solved unless additional ``constraints'' on the adjustable parameters can be introduced. Under other circumstances, we may want to introduce constraints on the adjustable parameters to add additional information, <em>e.g.</em>, the sum of angles of a triangle. In more complex cases, the forms of the constraints are unknown. Here we confine ourselves to least-squares fit problems in which the forms of constraints are known.</p>
<p>If the forms of constraint equations are known, the least-squares problem can be solved. (In the case where not enough independent observations are available, a minimum number of sufficient constraint equations have to be provided. The singular value decomposition method can be used to calculate the minimum number of orthogonal constraints needed).</p>
<h3>Nonlinear Least-Squares Fits</h3>
<p>We now consider the situation where the fitted function depends <em>nonlinearly</em> on the set of <em>M</em> adjustable parameters. But with nonlinear dependences the minimisation of chi<sup>2</sup> cannot proceed as in the linear case. However, we can <em>linearise</em> the problem, find an approximate solution, and then iteratively seek the minimising solution. The iteration stops when e.g. the adjusted parameters do not change anymore. In general it is very difficult to find a general solution that finds a global minimum, and the solution has to be matched with the problem. The Levenberg-Marquardt algorithm is a general non-linear fitting method which can produce correct results in many cases. It has been included, but always be aware of possible problems with non-linear solutions.</p>
<h3>What Is Available?</h3>
<p>The basic classes are <a class="el" href="classcasacore_1_1LSQFit.html">LSQFit </a> and <a class="el" href="classcasacore_1_1LSQaips.html">LSQaips </a> . They provide the basic framework for normal equation generation, solving the normal equations and iterating in the case of non-linear equations.</p>
<p>The <em><a class="el" href="classcasacore_1_1LSQFit.html" title="Basic class for the least squares fitting.">LSQFit</a></em> class uses a native C++ interface (pointers and iterators). They handle real data and complex data. The <em><a class="el" href="classcasacore_1_1LSQaips.html" title="Interface for Casacore Vectors in least squares fitting.">LSQaips</a></em> class offers the functionality of <em><a class="el" href="classcasacore_1_1LSQFit.html" title="Basic class for the least squares fitting.">LSQFit</a></em>, but with an additional Casacore <a class="el" href="classcasacore_1_1Array.html" title="template &lt;class T, class U&gt; class vector;">Array</a> interface.<br/>
</p>
<p>Functionality is </p>
<ol>
<li>
Fit a linear combination of functions to data points, and, optionally, use supplied constraint conditions on the adjustable parameters. </li>
<li>
Fit a nonlinear function to data points. The adjustable parameters are parameters inside the function. </li>
<li>
Repetitively perform a linear fit for every line of pixels parallel to any axis in a <a class="el" href="classcasacore_1_1Lattice.html" title="A templated, abstract base class for array-like objects.">Lattice</a>. </li>
<li>
Solve (as opposed to fit to a set of data), a set of equations </li>
</ol>
<p>In addition to the basic Least Squares routines in the <code><a class="el" href="classcasacore_1_1LSQFit.html" title="Basic class for the least squares fitting.">LSQFit</a></code> and <code><a class="el" href="classcasacore_1_1LSQaips.html" title="Interface for Casacore Vectors in least squares fitting.">LSQaips</a></code> classes, this module contains also a set of direct data fitters: </p>
<ul>
<li>
<code><a class="el" href="classcasacore_1_1Fit2D.html" title="Fit 2-D objects to 2-D Lattices or Arrays.">Fit2D</a></code> </li>
<li>
<code><a class="el" href="classcasacore_1_1LinearFit.html" title="Class for linear least-squares fit.">LinearFit</a></code> </li>
<li>
<code><a class="el" href="classcasacore_1_1LinearFitSVD.html" title="Linear least-squares fit using Singular Value Decomposition method.">LinearFitSVD</a></code> </li>
<li>
<code><a class="el" href="classcasacore_1_1NonLinearFit.html" title="Class for non-linear least-squares fit.">NonLinearFit</a></code> </li>
<li>
<code><a class="el" href="classcasacore_1_1NonLinearFitLM.html" title="Solve non-linear fit with Levenberg-Marquardt method.">NonLinearFitLM</a></code> </li>
</ul>
<p>Furthermore class <code><a class="el" href="classcasacore_1_1LatticeFit.html" title="Fit every line of pixels parallel to any axis in a Lattice.">LatticeFit</a></code> can do fitting on lattices.</p>
<p>Note that the basic functions have <em>LSQ</em> in their title; the one-step fitting functions <em>Fit</em>.</p>
<p>The above fitting problems can usually be solved by directly calling the <code>fit()</code> member function provided by one of the <code>Fit</code> classes above, or by gradually building the normal equation matrix and solving the normal equations (<code>solve()</code>).</p>
<p>A Distributed Object interface to the classes is available (<code>DOfitting</code>) for use in the <em>Glish</em> <code>dfit</code> object, available through the <code>fitting.g</code> script.</p>
<h3>Motivation</h3>
<p>This module was motivated by baseline subtraction/continuum fitting in the first instance.</p>
<h3>To Do</h3>
<ul>
<li>
extend the Fit interface classes to cater for building the normal equations in parts. </li>
</ul>
<p><a class="anchor" id="Fitting_module_Class_List"></a> </p>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Apr 1 2015 15:43:42 for casacore by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
